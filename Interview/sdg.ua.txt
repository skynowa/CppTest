Смарт Девелопмент Груп (www.sdg.ua)


Тестовое задание


Требуется сделать простую утилиту миграции mssql->oracle и обратно. Утилита должна переносить таблицы с данными и индексы между схемами (больше ничего не требуется). Утилита командной строки, вся логика – в отдельной dll в COM серверах (чтобы при желании можно было реализовать оконный UI на C#). Реализация на C++, ATL. Дизайн не должен быть слишком простым, нужно несколько связанных интерфейсов.


В целом код написан в весьма плохом процедурном стиле. Архитектура как таковая слабо выражена или отсутствует.
Обработка ошибок отсутствует. Исключения не используются.
Для строк используется char* практически везде, юникод не используется там где он необходим, STL или ATL строки не используются там где следовало бы.
Строки в SQL запросах не экранируются. К именам таблиц добавляется суффикс _proba, зачем?
Отсутствует минимальное понимание того что пишется, для примера
      Object1.cpp
      STDMETHODIMP st = S_OK;

Что это? Автор знает что такое STDMETHODIMP и зачем оно используется?
      if (export2(pc_src, pc_dst, pout, typedb) != 0) {
          st = ERROR;
      }

      return st;

единственное доступное определение ERROR находится в wingdi.h и выглядит как

      #define ERROR 0

при этом S_OK определено как

      #define S_OK ((HRESULT)0L)


так что даже если отбросить полное непонимание автором принциппов вызовов COM методов и обработки ошибок, то этот код ошибки обрабатывать не будет. Даже в таком примитивном виде.

Собственно сам COM объект описан ужасным образом,
Присутствуют неиспользуемые ненужные свойства с автогенерироваными заглушками.
Именование метода как put_export это явное нарушение соглашений о именовании методов и свойств(put_XXX и get_XXX это обычно «сеттер» и «геттер» свойств)

Передача строк в COM метод через char* это ошибка, так как строки следует передавать используя тип BSTR. Как передать char* из C#/VB?
